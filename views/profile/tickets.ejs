<% layout('layout') -%>
<section class="hero">
  <h1>My Tickets</h1>
</section>

<div class="card">
  <% if (!orders || orders.length === 0) { %>
    <p class="muted">You don't have any tickets yet.</p>
  <% } %>

  <div class="vstack" style="display:flex; flex-direction:column; gap:12px;">
  <% orders.forEach(o => { %>
    <% o.items.forEach(it => { %>
      <div class="ticket-card">
        <img class="thumb" src="<%= (o.eventId && o.eventId.coverImage) ? o.eventId.coverImage : 'https://placehold.co/160x160?text=Event' %>" alt="cover"/>
        <div class="meta">
          <div class="title"><a href="/events/<%= o.eventId._id %>"><%= o.eventId.title %></a></div>
          <div class="muted"><%= new Date(o.eventId.startAt).toLocaleString() %> @ <%= o.eventId.venue %></div>
          <div>🎟️ <strong><%= it.name %></strong> × <%= it.qty %></div>
          <div class="muted">Order: <%= o._id %></div>
        </div>
        <div class="price">฿<%= it.unitPrice * it.qty %></div>
      </div>
    <% }) %>
  <% }) %>
  </div>
</div>
